---
import ReplayIcon from "../global/icons/replay-icon.astro";
import Character from "../global/lotties/character.astro";
import { getI18N } from "../../i18n";
const i18n = getI18N(Astro.url.pathname);
---

<div
  id='game-card'
  class='game-card bg-primary text-white rounded-card p-4 size-full max-[900px]:h-[276px]'
>
  <div class='flex gap-2 w-full h-full'>
    <div
      class='flex-1 h-full bg-card p-4 rounded-card text-white relative overflow-hidden'
      id='gameContainer'
    >
      <span
        id='scoreText'
        class='opacity-0 absolute top-4 right-4 text-white text-2xl font-bold select-none'
        >Score: <span id='score'>0</span></span
      >
      <div
        class='w-[50px] h-[50px] absolute bottom-0 left-10 transition-transform duration-500 ease-out'
        id='player'
      >
        <Character />
      </div>
      <div
        class='absolute bottom-0 left-0 w-full h-full flex flex-col gap-4 justify-center items-center bg-black/20 backdrop-blur-xs z-3 select-none transition-all duration-500 ease-out'
        style='opacity: 0; transform: scale(0);'
        id='gameOverScreen'
      >
        <span class='text-white text-2xl font-bold pixelify-sans'
          >{i18n.ME_SECTION.GAME_SECTION.GAME_OVER}</span
        >
        <button
          class='relative bg-white p-4 rounded-card cursor-pointer hover:opacity-50 hover:scale-90 transition-all duration-500 ease-out z-40'
          id='gameReplayButton'
        >
          <ReplayIcon />
        </button>
      </div>
      <div
        class='absolute bottom-0 left-0 w-full h-full flex flex-col justify-center items-center gap-2 z-3 select-none transition-all duration-500 ease-out'
        id='gameStartScreen'
      >
        <!-- <button
          class='relative bg-white p-4 rounded-card cursor-pointer hover:opacity-50 hover:scale-90 transition-all duration-500 ease-out z-40'
          id='gameStartButton'
        > -->
        <p id='gameStartText' class='flex items-center gap-2 text-xl pixelify-sans'></p>
        <p id='gameStartText2' class='text-sm text-gray-400 pixelify-sans'>
          {i18n.ME_SECTION.GAME_SECTION.EASTER_EGG}
        </p>
        <!-- <PlayIcon />
        </button> -->
      </div>
      <div
        class='absolute bottom-0 left-0 w-full h-full flex flex-col gap-4 justify-center items-center bg-black/20 backdrop-blur-xs z-3 select-none transition-all duration-500 ease-out'
        style='opacity: 0; transform: scale(0);'
        id='gameWinScreen'
      >
        <span class='text-white text-4xl font-bold'
          class='pixelify-sans'
          >{i18n.ME_SECTION.GAME_SECTION.GAME_WIN} ðŸŽ‰</span
        >
      </div>
    </div>
  </div>
</div>

<script define:vars={{ i18n }}>
  document.addEventListener("astro:page-load", () => {
    const gameStartButtonText =
      i18n.ME_SECTION.GAME_SECTION.START_BUTTON.replace(
        "{{key}}",
        "<span class='text-primary bg-secondary px-2 py-1 rounded-md font-semibold text-vertical-reverse'>]</span>"
      );
    const gameStartTextElement = document.getElementById("gameStartText");
    if (gameStartTextElement) {
      gameStartTextElement.innerHTML = gameStartButtonText;
    }
  });
</script>

<script src='../../utils/game.ts'></script>

<style>
  @import url("https://fonts.googleapis.com/css2?family=Pixelify+Sans:wght@400..700&display=swap");

  .pixelify-sans {
    font-family: "Pixelify Sans", sans-serif;
  }
</style>
